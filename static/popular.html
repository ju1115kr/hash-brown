<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="controller.js"></script>
  <style media="screen">
    #container {
      width: 1200px;
      margin: 0px auto;
      padding: 20px;
      border: 1px solid #bcbcbc;
      height: 940px;
    }

    #content {
      width: 700px;
      padding: 20px;
      margin-bottom: 20px;
      float: left;
      border: 1px solid #bcbcbc;
    }

    #sidebar {
      width: 350px;
      padding: 20px;
      margin-bottom: 20px;
      float: right;
      border: 1px solid #bcbcbc;
    }
  </style>
  <title>welcome to Real News Plat.</title>
  <link rel="stylesheet" type="text/css" href="../stylesheets/navstyle.css">
</head>
<nav>
  <div id="topMenu">
    <div id="navBar">
      <div id="logo" style='display:inline;'>
        <img src="../resources/logo.png" width="30%" height="30%" margin="30px;">
      </div>
      <div id="searchBar" style='display:inline; margin-left: 70px;'>
        <input type="text" id="search" placeholder="검색어 입력">
        <button type="button" name="searchButton">검색</button>
      </div>
      <div id="log" style='display:inline; margin-left: 100px;'>
        <input class="log" id="id" type="text" placeholder="id">
        <input class="log" id="password" type="password" placeholder="password">
        <button type="button" id="loginButton" onclick="logIn($('#id').val(),$('#password').val())">로그인</button>
      </div>
    </div>
    <div id="menu">
      <a class="menubtn" id="notice" type="button" name="button" onclick="goToNotice()">공지사항</a>
      <a class="menubtn" id="popular" type="button" name="button" onclick="goToPopular()">인기글</a>
      <a class="menubtn" id="latest" type="button" name="button" onclick="goToDashboard()">최신글</a>
      <a class="menubtn" id="rangking" type="button" name="button" onclick="goToRanking()">순위</a>
      <a class="menubtn" id="write" type="button" name="button" onclick="goToWritePage()">글쓰기</a>
    </div>
</nav>

<body>
  <div id="content">
    <script type="text/javascript">
      $(document).ready(function() {
        $.ajax({
          type: 'GET',
          url: "http://35.234.3.182:9009/api/v1.0/news/star",
          beforeSend: function(xhr) {
            xhr.setRequestHeader("Authorization", "Basic " + btoa("t2" + ":" + "t2"));
          },
          data: {},
          success: function(data) {
            if (data.news.length === 0) {
              alert("기사가 없습니다. error!");
              return;
            }
            tempdata = data;
            var init = 0;
            for (var i = 0; i < data.length; i++) {
              if (tempdata.news[i].title !== undefined) {
                init = i;
                break;
              }
            }

            for (var i = init; i < init + 7; i++) {
              var tempTitle = tempdata.news[i].title;
              var tempAuthor = tempdata.news[i].author;
              var tempStar = tempdata.news[i].starcount;
              var tempField = tempdata.news[i].field;
              var tempAsso = tempdata.news[i].associated_reply;
              var space = " ";
              $("#articles").append("</br><img src = '../resources/news.jpg' height = 100px; width = 200px;></img>");
              $("#articles").append("<span>"+space + tempTitle + space);
              $("#articles").append("<img src = '../resources/user.jpg' width = 15px; height = 15px;></img>" + space + tempAuthor + space);
              $("#articles").append("<img src = '../resources/star.jpg' width = 15px; height = 15px;></img>" + space + tempStar + space);
              $("#articles").append("<img src = '../resources/agree.jpg' width = 15px; height = 15px;></img></span>" + space + tempAsso + "</br><hr>");
            }

          },
          error: function() {
            alert("article error!");
          }
        })
      });
    </script>
    <table style="width:100%" id="articles">
    </table>
  </div>
  <div id="sidebar">
    <script type="text/javascript">
      $(document).ready(function() {
        $.ajax({
          type: 'GET',
          url: "http://35.234.3.182:9009/api/v1.0/users/star",
          beforeSend: function(xhr) {
            xhr.setRequestHeader("Authorization", "Basic " + btoa("t2" + ":" + "t2"));
          },
          data: {},
          success: function(data) {
            console.log("success");
            tempdata = data;
            for (var i = 0; i < tempdata.users.length; i++) {
              var tempName = tempdata.users[i].realname;
              var tempStar = tempdata.users[i].starcount;
              var space = " ";
              var count = i + 1;
              $("#users").append(count + ". " + space + "<img src = '../resources/silver.png' height = 15px; width = 15px;></img>" + space + tempName + "<img src = '../resources/star.jpg' height = 15px; width = 15px;>" + tempStar +
                "</br>");
            }
          },
          error: function() {
            alert("user-ranking error!");
          }
        })
      });
    </script>
    <div id="category">
      <h2>주제</h2>
      <h5>정치</h5>
      <h5>경제</h5>
      <h5>사회</h5>
      <h5>시사</h5>
      <h5>연예</h5>
      <h5>스포츠</h5>
      <h5>기타<hr></h5>
    </div>
    <table id="users">
      <h2>유저순위</h2>
    </table>
  </div>
</body>

</html>
